this is rewriten in cpp only for 64 bit for now
